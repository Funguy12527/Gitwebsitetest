<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Work_2</title>

    <!-- 复用主站样式 -->
    <link rel="stylesheet" href="../css/vendor.css" />
    <link rel="stylesheet" href="../css/styles.css" />

    <style>
        /* 页面局部样式 */
        :root {
            --gap: 28px;
            --radius: 10px;
        }
        body {
            background: #fff;
        }
        .wrap {
            max-width: 1200px;
            margin: 120px auto 48px;
            padding: 0 20px;
        }
        .case-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: var(--gap);
            align-items: center;
            margin-bottom: 56px;
        }
        .case-section:first-of-type {
            margin-top: 150px;
            margin-bottom: 0px !important;
            align-items: start;
        }
        .case-section:first-of-type .case-image {
            margin-top: 300px;
        }
        .case-section:nth-of-type(2) {
            margin-top: -400px !important;
            margin-bottom: 20px;
            align-items: start;
        }
        .case-section:nth-of-type(3) .case-text {
            margin-top: 80px;
        }
        .case-image img {
            width: 100%;
            height: auto;
            display: block;
            border-radius: var(--radius);
            object-fit: cover;
            box-shadow: 0 6px 24px rgba(0,0,0,.08);
        }
        .case-title {
            font-size: 4.0rem;
            font-weight: 800;
            margin: 0 0 12px;
        }
        .case-heading {
            font-size: 3.0rem;
            font-weight: 800;
            margin: 18px 0 8px;
        }
        .case-subtitle {
            font-size: 2.0rem;
            font-weight: 700;
            margin: 18px 0 8px;
        }
        .case-text p {
            margin: 0 0 6px;
            line-height: 1.7;
        }
        .case-text ul {
            margin: 8px 0 0 18px;
        }
        .case-text li {
            margin: 4px 0;
        }
        .case-text a {
            color: inherit;
            text-decoration: underline;
            word-break: break-all;
        }
        /* 图片轮播 */
        .image-carousel {
            position: relative;
            width: 100%;
            border-radius: var(--radius);
            overflow: hidden;
            box-shadow: 0 6px 24px rgba(0,0,0,.08);
            transition: height 1s ease-in-out;
        }
        .image-carousel-container {
            display: flex;
            width: 600%;
            animation: slide 18s infinite;
        }
        .image-carousel-item {
            width: 16.666%;
            flex-shrink: 0;
        }
        .image-carousel-item img {
            width: 100%;
            height: auto;
            display: block;
            border-radius: 0;
        }
        @keyframes slide {
            0%, 13.33% {
                transform: translateX(0);
            }
            16.66%, 30% {
                transform: translateX(-16.666%);
            }
            33.33%, 46.66% {
                transform: translateX(-33.333%);
            }
            50%, 63.33% {
                transform: translateX(-50%);
            }
            66.66%, 80% {
                transform: translateX(-66.666%);
            }
            83.33%, 96.66% {
                transform: translateX(-83.333%);
            }
            100% {
                transform: translateX(0);
            }
        }
        /* 3图片轮播样式 */
        .image-carousel-container.carousel-3 {
            width: 300%;
            animation: slide3 9s infinite;
        }
        .image-carousel-container.carousel-3 .image-carousel-item {
            width: 33.333%;
        }
        @keyframes slide3 {
            0%, 26.66% {
                transform: translateX(0);
            }
            33.33%, 60% {
                transform: translateX(-33.333%);
            }
            66.66%, 93.33% {
                transform: translateX(-66.666%);
            }
            100% {
                transform: translateX(0);
            }
        }
        /* 4图片轮播样式 */
        .image-carousel-container.carousel-4 {
            width: 400%;
            animation: slide4 12s infinite;
        }
        .image-carousel-container.carousel-4 .image-carousel-item {
            width: 25%;
        }
        @keyframes slide4 {
            0%, 20% {
                transform: translateX(0);
            }
            25%, 45% {
                transform: translateX(-25%);
            }
            50%, 70% {
                transform: translateX(-50%);
            }
            75%, 95% {
                transform: translateX(-75%);
            }
            100% {
                transform: translateX(0);
            }
        }
        /* 新增：响应式 16:9 播放器容器 */
        .video-embed {
            position: relative;
            width: 100%;
            padding-top: 56.25%; /* 16:9 */
            border-radius: var(--radius);
            overflow: hidden;
            box-shadow: 0 6px 24px rgba(0,0,0,.08);
            margin: 8px 0 16px;
        }
        .video-embed iframe {
            position: absolute;
            inset: 0;
            width: 100%;
            height: 100%;
            border: 0;
        }
        /* 第二段：图片在左（默认）；第一/第三段通过顺序控制图片在右 */
        .image-right .case-text { order: 1; }
        .image-right .case-image { order: 2; }

        @media (max-width: 900px) {
            .case-section {
                grid-template-columns: 1fr;
            }
            .image-right .case-text,
            .image-right .case-image {
                order: initial;
            }
        }
    </style>
</head>
<body>

<main class="wrap">

    <!-- 第一块：图片在右，文字在左 -->
    <section class="case-section image-right">
        <div class="case-text">
            <h2 class="case-title">2025 Into The Deep</h2>
            <ul>
                <li>Chenzhou Qualifier Winning Alliance</li>
                <li>Chenzhou Qualifier Inspire Award</li>
                <li>China National Championship Innovation Award</li>
            </ul>

            <h3 class="case-heading">Robot CAD</h3>
            <p>
                <a href="https://www.chiefdelphi.com/t/ftc-12527-prototype-2025-build-thread/473681/29?u=funguy" target="_blank" rel="noopener">
                    https://www.chiefdelphi.com/t/ftc-12527-prototype-2025-build-thread/473681/29?u=funguy
                </a>
            </p>
            <h3 class="case-heading">Open Alliance Blog</h3>
            <p>
                <a href="https://www.chiefdelphi.com/t/ftc-12527-prototype-2025-build-thread/473681?u=funguy" target="_blank" rel="noopener">
                    https://www.chiefdelphi.com/t/ftc-12527-prototype-2025-build-thread/473681?u=funguy
                </a>
            </p>
            <h4 class="case-subtitle">Videos</h4>
            <p>Season Recap</p>
            <div class="video-embed">
                <iframe src="https://www.youtube-nocookie.com/embed/VjUSoOgO0yU"
                        title="Season Recap"
                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                        allowfullscreen></iframe>
            </div>

            <p>FTC Open Alliance Award Ceremony</p>
            <div class="video-embed">
                <iframe src="https://www.youtube-nocookie.com/embed/iIazoCRcUf0?start=287"
                        title="FTC Open Alliance Award Ceremony"
                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                        allowfullscreen></iframe>
            </div>
        </div>
        <div class="case-image">
            <div class="image-carousel">
                <div class="image-carousel-container carousel-3">
                    <div class="image-carousel-item">
                        <img src="../images/works/FTC1/顺序1.jpeg" alt="Robot iteration" />
                    </div>
                    <div class="image-carousel-item">
                        <img src="../images/works/FTC1/顺序2.jpg" alt="Robot iteration" />
                    </div>
                    <div class="image-carousel-item">
                        <img src="../images/works/FTC1/顺序3.jpg" alt="Robot iteration" />
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- FTC 2 section -->
    <section class="case-section image-right">
        <div class="case-text">
        </div>
        <div class="case-image">
            <div class="image-carousel">
                <div class="image-carousel-container carousel-4">
                    <div class="image-carousel-item">
                        <img src="../images/works/FTC2/d27f059494a0cc5ef23824f66c89a747.JPG" alt="FTC 2" />
                    </div>
                    <div class="image-carousel-item">
                        <img src="../images/works/FTC2/d27f059494a0cc5ef23824f66c89a747.JPG" alt="FTC 2" />
                    </div>
                    <div class="image-carousel-item">
                        <img src="../images/works/FTC2/IMG_2891.JPG" alt="FTC 2" />
                    </div>
                    <div class="image-carousel-item">
                        <img src="../images/works/FTC2/IMG_2896.JPG" alt="FTC 2" />
                    </div>
                </div>
            </div>
        </div>
    </section>

</main>

<script>
    // Store carousel data for efficient updates
    const carouselData = new Map();
    
    // Function to get the natural height of an image based on carousel width
    function getImageNaturalHeight(img, carouselWidth) {
        if (img.naturalHeight && img.naturalWidth && img.naturalWidth > 0) {
            const aspectRatio = img.naturalHeight / img.naturalWidth;
            return carouselWidth * aspectRatio;
        }
        return img.offsetHeight || 0;
    }
    
    // Initialize carousel data
    function initializeCarousels() {
        const carousels = document.querySelectorAll('.image-carousel');
        
        carousels.forEach(carousel => {
            const container = carousel.querySelector('.image-carousel-container');
            const items = carousel.querySelectorAll('.image-carousel-item');
            
            if (!container || items.length === 0) return;
            
            const animationDuration = parseFloat(getComputedStyle(container).animationDuration) * 1000 || 18000;
            const imageCount = items.length;
            const timePerImage = animationDuration / imageCount;
            
            // Pre-calculate heights for all images
            const carouselWidth = carousel.offsetWidth;
            const imageHeights = [];
            
            items.forEach(item => {
                const img = item.querySelector('img');
                if (img) {
                    const height = getImageNaturalHeight(img, carouselWidth);
                    imageHeights.push(height);
                } else {
                    imageHeights.push(0);
                }
            });
            
            carouselData.set(carousel, {
                container,
                items,
                animationDuration,
                imageCount,
                timePerImage,
                imageHeights,
                lastIndex: -1
            });
        });
    }
    
    // Get current image index based on animation progress and keyframes
    function getCurrentImageIndex(progress, imageCount) {
        if (imageCount === 6) {
            if (progress <= 13 || progress >= 96.66) return 0;
            if (progress >= 13 && progress <= 30) return 1;
            if (progress >= 30 && progress <= 46.66) return 2;
            if (progress >= 46.66 && progress <= 63.33) return 3;
            if (progress >= 63.33 && progress <= 80) return 4;
            if (progress >= 80 && progress <= 96.66) return 5;
            return 0;
        } else if (imageCount === 5) {
            if (progress <= 16 || progress >= 96) return 0;
            if (progress >= 20 && progress <= 36) return 1;
            if (progress >= 40 && progress <= 56) return 2;
            if (progress >= 60 && progress <= 76) return 3;
            if (progress >= 80 && progress <= 96) return 4;
            if (progress > 16 && progress < 20) return 1;
            if (progress > 36 && progress < 40) return 2;
            if (progress > 56 && progress < 60) return 3;
            if (progress > 76 && progress < 80) return 4;
            return 0;
        } else if (imageCount === 4) {
            if (progress <= 20 || progress >= 95) return 0;
            if (progress >= 20 && progress <= 45) return 1;
            if (progress >= 45 && progress <= 70) return 2;
            if (progress >= 70 && progress <= 95) return 3;
            return 0;
        } else if (imageCount === 3) {
            if (progress <= 26.66 || progress >= 93.33) return 0;
            if (progress >= 26.66 && progress <= 60) return 1;
            if (progress >= 60 && progress <= 93.33) return 2;
            return 0;
        }
        return Math.min(Math.floor((progress / 100) * imageCount), imageCount - 1);
    }
    
    // Function to update carousel height based on visible image
    function updateCarouselHeights() {
        carouselData.forEach((data, carousel) => {
            const carouselWidth = carousel.offsetWidth;
            if (carouselWidth === 0) return;
            
            // Recalculate heights if width changed
            if (data.lastWidth !== carouselWidth) {
                data.items.forEach((item, index) => {
                    const img = item.querySelector('img');
                    if (img) {
                        data.imageHeights[index] = getImageNaturalHeight(img, carouselWidth);
                    }
                });
                data.lastWidth = carouselWidth;
            }
            
            // Calculate animation progress percentage
            const now = performance.now();
            const cycleTime = data.animationDuration;
            const timeInCycle = (now % cycleTime);
            const progress = (timeInCycle / cycleTime) * 100;
            
            // Get current image index based on keyframe percentages
            const currentIndex = getCurrentImageIndex(progress, data.imageCount);
            
            // Update height if index changed
            if (currentIndex !== data.lastIndex && data.imageHeights[currentIndex] > 0) {
                carousel.style.height = data.imageHeights[currentIndex] + 'px';
                data.lastIndex = currentIndex;
            }
        });
    }
    
    // Animation loop using requestAnimationFrame for smooth updates
    let animationFrameId;
    function animate() {
        updateCarouselHeights();
        animationFrameId = requestAnimationFrame(animate);
    }
    
    // Wait for all images to load, then start updating
    window.addEventListener('load', function() {
        setTimeout(() => {
            initializeCarousels();
            animate();
        }, 300);
    });
    
    // Update when images load individually
    document.querySelectorAll('.image-carousel-item img').forEach(img => {
        if (img.complete) {
            if (carouselData.size > 0) {
                initializeCarousels();
            }
        } else {
            img.addEventListener('load', function() {
                initializeCarousels();
            });
        }
    });
    
    // Also update on window resize
    let resizeTimeout;
    window.addEventListener('resize', function() {
        clearTimeout(resizeTimeout);
        resizeTimeout = setTimeout(() => {
            initializeCarousels();
        }, 100);
    });
</script>

</body>
</html>